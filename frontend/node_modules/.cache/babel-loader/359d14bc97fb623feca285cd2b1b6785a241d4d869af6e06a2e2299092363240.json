{"ast":null,"code":"// src/api.js\n\n// Base URL for your backend.\n// With your current setup this will be \"/api\" and CRA proxy will forward it.\nconst API_BASE = process.env.REACT_APP_API_BASE || \"/api\";\n\n// Helper: read token from localStorage and build Authorization header\nfunction getAuthHeaders() {\n  const stored = localStorage.getItem(\"user\");\n  if (!stored) return {};\n  try {\n    const parsed = JSON.parse(stored);\n    if (!parsed || !parsed.token) {\n      return {};\n    }\n    return {\n      Authorization: `Bearer ${parsed.token}`\n    };\n  } catch (err) {\n    console.error(\"Failed to parse user from localStorage\", err);\n    return {};\n  }\n}\n\n// Common response handler\nasync function handle(res) {\n  const ct = res.headers.get(\"content-type\") || \"\";\n  if (!res.ok) {\n    if (ct.includes(\"application/json\")) {\n      const data = await res.json().catch(() => ({}));\n      const msg = (data === null || data === void 0 ? void 0 : data.error) || JSON.stringify(data) || `HTTP ${res.status}`;\n      throw new Error(msg);\n    } else {\n      const text = await res.text();\n      throw new Error(`Non JSON response (status ${res.status}): ${text.slice(0, 200)}`);\n    }\n  }\n  if (ct.includes(\"application/json\")) {\n    return res.json();\n  }\n  return res.text();\n}\n\n// ---------------------------------------------------\n// PLANTS API - all routes are protected by requireAuth\n// ---------------------------------------------------\n\nexport const PlantsAPI = {\n  // GET /api/plants\n  list: () => fetch(`${API_BASE}/plants`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  }).then(handle),\n  // GET /api/plants/:id\n  get: id => fetch(`${API_BASE}/plants/${id}`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  }).then(handle),\n  // POST /api/plants\n  create: payload => fetch(`${API_BASE}/plants`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(payload)\n  }).then(handle),\n  // PATCH /api/plants/:id\n  update: (id, payload) => fetch(`${API_BASE}/plants/${id}`, {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(payload)\n  }).then(handle),\n  // DELETE /api/plants/:id\n  delete: id => fetch(`${API_BASE}/plants/${id}`, {\n    method: \"DELETE\",\n    headers: {\n      ...getAuthHeaders()\n    }\n  }).then(handle)\n};\n\n// ---------------------------------------------------\n// GENERA API (optional helper if you use it later)\n// ---------------------------------------------------\n\nexport const GeneraAPI = {\n  // GET /api/genera\n  list: () => fetch(`${API_BASE}/genera`).then(handle),\n  // GET /api/genera/:name\n  get: name => fetch(`${API_BASE}/genera/${encodeURIComponent(name)}`).then(handle)\n};\n\n// ---------------------------------------------------\n// WEATHER API (optional helper if you use it later)\n// ---------------------------------------------------\n\nexport const WeatherAPI = {\n  // GET /api/weather?city=Manila or other params\n  get: params => {\n    const queryString = new URLSearchParams(params).toString();\n    return fetch(`${API_BASE}/weather?${queryString}`).then(handle);\n  }\n};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","getAuthHeaders","stored","localStorage","getItem","parsed","JSON","parse","token","Authorization","err","console","error","handle","res","ct","headers","get","ok","includes","data","json","catch","msg","stringify","status","Error","text","slice","PlantsAPI","list","fetch","then","id","create","payload","method","body","update","delete","GeneraAPI","name","encodeURIComponent","WeatherAPI","params","queryString","URLSearchParams","toString"],"sources":["C:/Users/admin/Documents/GitHub/meetur-garden-thesis/frontend/src/api.js"],"sourcesContent":["// src/api.js\r\n\r\n// Base URL for your backend.\r\n// With your current setup this will be \"/api\" and CRA proxy will forward it.\r\nconst API_BASE = process.env.REACT_APP_API_BASE || \"/api\";\r\n\r\n// Helper: read token from localStorage and build Authorization header\r\nfunction getAuthHeaders() {\r\n  const stored = localStorage.getItem(\"user\");\r\n  if (!stored) return {};\r\n\r\n  try {\r\n    const parsed = JSON.parse(stored);\r\n    if (!parsed || !parsed.token) {\r\n      return {};\r\n    }\r\n\r\n    return { Authorization: `Bearer ${parsed.token}` };\r\n  } catch (err) {\r\n    console.error(\"Failed to parse user from localStorage\", err);\r\n    return {};\r\n  }\r\n}\r\n\r\n// Common response handler\r\nasync function handle(res) {\r\n  const ct = res.headers.get(\"content-type\") || \"\";\r\n\r\n  if (!res.ok) {\r\n    if (ct.includes(\"application/json\")) {\r\n      const data = await res.json().catch(() => ({}));\r\n      const msg = data?.error || JSON.stringify(data) || `HTTP ${res.status}`;\r\n      throw new Error(msg);\r\n    } else {\r\n      const text = await res.text();\r\n      throw new Error(\r\n        `Non JSON response (status ${res.status}): ${text.slice(0, 200)}`\r\n      );\r\n    }\r\n  }\r\n\r\n  if (ct.includes(\"application/json\")) {\r\n    return res.json();\r\n  }\r\n\r\n  return res.text();\r\n}\r\n\r\n// ---------------------------------------------------\r\n// PLANTS API - all routes are protected by requireAuth\r\n// ---------------------------------------------------\r\n\r\nexport const PlantsAPI = {\r\n  // GET /api/plants\r\n  list: () =>\r\n    fetch(`${API_BASE}/plants`, {\r\n      headers: {\r\n        ...getAuthHeaders()\r\n      }\r\n    }).then(handle),\r\n\r\n  // GET /api/plants/:id\r\n  get: (id) =>\r\n    fetch(`${API_BASE}/plants/${id}`, {\r\n      headers: {\r\n        ...getAuthHeaders()\r\n      }\r\n    }).then(handle),\r\n\r\n  // POST /api/plants\r\n  create: (payload) =>\r\n    fetch(`${API_BASE}/plants`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        ...getAuthHeaders()\r\n      },\r\n      body: JSON.stringify(payload)\r\n    }).then(handle),\r\n\r\n  // PATCH /api/plants/:id\r\n  update: (id, payload) =>\r\n    fetch(`${API_BASE}/plants/${id}`, {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        ...getAuthHeaders()\r\n      },\r\n      body: JSON.stringify(payload)\r\n    }).then(handle),\r\n\r\n  // DELETE /api/plants/:id\r\n  delete: (id) =>\r\n    fetch(`${API_BASE}/plants/${id}`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        ...getAuthHeaders()\r\n      }\r\n    }).then(handle)\r\n};\r\n\r\n// ---------------------------------------------------\r\n// GENERA API (optional helper if you use it later)\r\n// ---------------------------------------------------\r\n\r\nexport const GeneraAPI = {\r\n  // GET /api/genera\r\n  list: () => fetch(`${API_BASE}/genera`).then(handle),\r\n\r\n  // GET /api/genera/:name\r\n  get: (name) =>\r\n    fetch(`${API_BASE}/genera/${encodeURIComponent(name)}`).then(handle)\r\n};\r\n\r\n// ---------------------------------------------------\r\n// WEATHER API (optional helper if you use it later)\r\n// ---------------------------------------------------\r\n\r\nexport const WeatherAPI = {\r\n  // GET /api/weather?city=Manila or other params\r\n  get: (params) => {\r\n    const queryString = new URLSearchParams(params).toString();\r\n    return fetch(`${API_BASE}/weather?${queryString}`).then(handle);\r\n  }\r\n};\r\n"],"mappings":"AAAA;;AAEA;AACA;AACA,MAAMA,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,MAAM;;AAEzD;AACA,SAASC,cAAcA,CAAA,EAAG;EACxB,MAAMC,MAAM,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;EAC3C,IAAI,CAACF,MAAM,EAAE,OAAO,CAAC,CAAC;EAEtB,IAAI;IACF,MAAMG,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACL,MAAM,CAAC;IACjC,IAAI,CAACG,MAAM,IAAI,CAACA,MAAM,CAACG,KAAK,EAAE;MAC5B,OAAO,CAAC,CAAC;IACX;IAEA,OAAO;MAAEC,aAAa,EAAE,UAAUJ,MAAM,CAACG,KAAK;IAAG,CAAC;EACpD,CAAC,CAAC,OAAOE,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,wCAAwC,EAAEF,GAAG,CAAC;IAC5D,OAAO,CAAC,CAAC;EACX;AACF;;AAEA;AACA,eAAeG,MAAMA,CAACC,GAAG,EAAE;EACzB,MAAMC,EAAE,GAAGD,GAAG,CAACE,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,IAAI,EAAE;EAEhD,IAAI,CAACH,GAAG,CAACI,EAAE,EAAE;IACX,IAAIH,EAAE,CAACI,QAAQ,CAAC,kBAAkB,CAAC,EAAE;MACnC,MAAMC,IAAI,GAAG,MAAMN,GAAG,CAACO,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;MAC/C,MAAMC,GAAG,GAAG,CAAAH,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAER,KAAK,KAAIN,IAAI,CAACkB,SAAS,CAACJ,IAAI,CAAC,IAAI,QAAQN,GAAG,CAACW,MAAM,EAAE;MACvE,MAAM,IAAIC,KAAK,CAACH,GAAG,CAAC;IACtB,CAAC,MAAM;MACL,MAAMI,IAAI,GAAG,MAAMb,GAAG,CAACa,IAAI,CAAC,CAAC;MAC7B,MAAM,IAAID,KAAK,CACb,6BAA6BZ,GAAG,CAACW,MAAM,MAAME,IAAI,CAACC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,EACjE,CAAC;IACH;EACF;EAEA,IAAIb,EAAE,CAACI,QAAQ,CAAC,kBAAkB,CAAC,EAAE;IACnC,OAAOL,GAAG,CAACO,IAAI,CAAC,CAAC;EACnB;EAEA,OAAOP,GAAG,CAACa,IAAI,CAAC,CAAC;AACnB;;AAEA;AACA;AACA;;AAEA,OAAO,MAAME,SAAS,GAAG;EACvB;EACAC,IAAI,EAAEA,CAAA,KACJC,KAAK,CAAC,GAAGlC,QAAQ,SAAS,EAAE;IAC1BmB,OAAO,EAAE;MACP,GAAGf,cAAc,CAAC;IACpB;EACF,CAAC,CAAC,CAAC+B,IAAI,CAACnB,MAAM,CAAC;EAEjB;EACAI,GAAG,EAAGgB,EAAE,IACNF,KAAK,CAAC,GAAGlC,QAAQ,WAAWoC,EAAE,EAAE,EAAE;IAChCjB,OAAO,EAAE;MACP,GAAGf,cAAc,CAAC;IACpB;EACF,CAAC,CAAC,CAAC+B,IAAI,CAACnB,MAAM,CAAC;EAEjB;EACAqB,MAAM,EAAGC,OAAO,IACdJ,KAAK,CAAC,GAAGlC,QAAQ,SAAS,EAAE;IAC1BuC,MAAM,EAAE,MAAM;IACdpB,OAAO,EAAE;MACP,cAAc,EAAE,kBAAkB;MAClC,GAAGf,cAAc,CAAC;IACpB,CAAC;IACDoC,IAAI,EAAE/B,IAAI,CAACkB,SAAS,CAACW,OAAO;EAC9B,CAAC,CAAC,CAACH,IAAI,CAACnB,MAAM,CAAC;EAEjB;EACAyB,MAAM,EAAEA,CAACL,EAAE,EAAEE,OAAO,KAClBJ,KAAK,CAAC,GAAGlC,QAAQ,WAAWoC,EAAE,EAAE,EAAE;IAChCG,MAAM,EAAE,OAAO;IACfpB,OAAO,EAAE;MACP,cAAc,EAAE,kBAAkB;MAClC,GAAGf,cAAc,CAAC;IACpB,CAAC;IACDoC,IAAI,EAAE/B,IAAI,CAACkB,SAAS,CAACW,OAAO;EAC9B,CAAC,CAAC,CAACH,IAAI,CAACnB,MAAM,CAAC;EAEjB;EACA0B,MAAM,EAAGN,EAAE,IACTF,KAAK,CAAC,GAAGlC,QAAQ,WAAWoC,EAAE,EAAE,EAAE;IAChCG,MAAM,EAAE,QAAQ;IAChBpB,OAAO,EAAE;MACP,GAAGf,cAAc,CAAC;IACpB;EACF,CAAC,CAAC,CAAC+B,IAAI,CAACnB,MAAM;AAClB,CAAC;;AAED;AACA;AACA;;AAEA,OAAO,MAAM2B,SAAS,GAAG;EACvB;EACAV,IAAI,EAAEA,CAAA,KAAMC,KAAK,CAAC,GAAGlC,QAAQ,SAAS,CAAC,CAACmC,IAAI,CAACnB,MAAM,CAAC;EAEpD;EACAI,GAAG,EAAGwB,IAAI,IACRV,KAAK,CAAC,GAAGlC,QAAQ,WAAW6C,kBAAkB,CAACD,IAAI,CAAC,EAAE,CAAC,CAACT,IAAI,CAACnB,MAAM;AACvE,CAAC;;AAED;AACA;AACA;;AAEA,OAAO,MAAM8B,UAAU,GAAG;EACxB;EACA1B,GAAG,EAAG2B,MAAM,IAAK;IACf,MAAMC,WAAW,GAAG,IAAIC,eAAe,CAACF,MAAM,CAAC,CAACG,QAAQ,CAAC,CAAC;IAC1D,OAAOhB,KAAK,CAAC,GAAGlC,QAAQ,YAAYgD,WAAW,EAAE,CAAC,CAACb,IAAI,CAACnB,MAAM,CAAC;EACjE;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}