{"ast":null,"code":"// src/utils/careEngine.js\n\nconst parseRange = rangeStr => {\n  if (!rangeStr) return null;\n  const cleanStr = rangeStr.replace(/[^0-9-]/g, \"\");\n  const parts = cleanStr.split(\"-\");\n  if (parts.length === 2) {\n    return {\n      min: Number(parts[0]),\n      max: Number(parts[1])\n    };\n  }\n  return null;\n};\nconst differenceInDays = (date1, date2) => {\n  const diff = Math.abs(date1 - date2);\n  return diff / (1000 * 60 * 60 * 24);\n};\n\n// Changed from 'const analyzePlantHealth =' to 'export const analyzePlantHealth ='\nexport const analyzePlantHealth = (plant, weatherData, gardenItem = null) => {\n  const alerts = [];\n  const status = {\n    health: \"OPTIMAL\",\n    alerts: [],\n    next_actions: {}\n  };\n\n  // SAFETY CHECK: If weather or plant data is missing, return a loading state\n  if (!weatherData || !plant || !plant.ecological_descriptors) {\n    return {\n      health: \"ANALYZING...\",\n      alerts: [],\n      next_actions: {}\n    };\n  }\n\n  // 1. Check Temperature\n  const currentTemp = weatherData.main.temp;\n  const tempRange = parseRange(plant.ecological_descriptors.temperature_range);\n  if (tempRange) {\n    if (currentTemp < tempRange.min) {\n      alerts.push(`TOO COLD! CURR: ${Math.round(currentTemp)}Â°C (NEEDS ${tempRange.min}Â°C)`);\n    } else if (currentTemp > tempRange.max) {\n      alerts.push(`TOO HOT! CURR: ${Math.round(currentTemp)}Â°C (MAX ${tempRange.max}Â°C)`);\n    }\n  }\n\n  // 2. Humidity Check\n  const currentHumidity = weatherData.main.humidity;\n  const humidityReq = plant.ecological_descriptors.humidity_level || \"\";\n  if (humidityReq.toLowerCase().includes(\"high\") && currentHumidity < 40) {\n    alerts.push(`DRY AIR (${currentHumidity}%). MIST NEEDED.`);\n  }\n\n  // 3. Smart Watering Schedule\n  if (gardenItem && gardenItem.last_watered) {\n    const daysSinceWatering = differenceInDays(new Date(), new Date(gardenItem.last_watered));\n    let requiredDays = 7;\n    const freq = plant.ecological_descriptors.water_frequency.toLowerCase();\n    if (freq.includes(\"daily\")) requiredDays = 1;else if (freq.includes(\"bi-weekly\") || freq.includes(\"2 weeks\")) requiredDays = 14;else if (freq.includes(\"weekly\")) requiredDays = 7;\n    const isRaining = weatherData.weather[0].main.toLowerCase().includes(\"rain\");\n    if (isRaining) {\n      requiredDays += 2;\n      alerts.push(\"ðŸŒ§ï¸ RAIN DETECTED: WATERING DELAYED 2 DAYS.\");\n    }\n    const dueInDays = requiredDays - daysSinceWatering;\n    if (dueInDays <= 0) {\n      status.health = \"THIRSTY\";\n      status.next_actions.water_in = \"NOW\";\n      alerts.push(`ðŸ’§ TIME TO WATER!`);\n    } else {\n      status.next_actions.water_in = `${Math.round(dueInDays)} DAYS`;\n    }\n  }\n  if (alerts.length > 0 && status.health === \"OPTIMAL\") {\n    status.health = \"NEEDS ATTENTION\";\n  }\n  status.alerts = alerts;\n  return status;\n};","map":{"version":3,"names":["parseRange","rangeStr","cleanStr","replace","parts","split","length","min","Number","max","differenceInDays","date1","date2","diff","Math","abs","analyzePlantHealth","plant","weatherData","gardenItem","alerts","status","health","next_actions","ecological_descriptors","currentTemp","main","temp","tempRange","temperature_range","push","round","currentHumidity","humidity","humidityReq","humidity_level","toLowerCase","includes","last_watered","daysSinceWatering","Date","requiredDays","freq","water_frequency","isRaining","weather","dueInDays","water_in"],"sources":["C:/Users/renee/Documents/GitHub/meetur-garden-thesis/frontend/src/utils/careEngine.js"],"sourcesContent":["// src/utils/careEngine.js\r\n\r\nconst parseRange = (rangeStr) => {\r\n  if (!rangeStr) return null;\r\n  const cleanStr = rangeStr.replace(/[^0-9-]/g, \"\");\r\n  const parts = cleanStr.split(\"-\");\r\n  if (parts.length === 2) {\r\n    return { min: Number(parts[0]), max: Number(parts[1]) };\r\n  }\r\n  return null;\r\n};\r\n\r\nconst differenceInDays = (date1, date2) => {\r\n  const diff = Math.abs(date1 - date2);\r\n  return diff / (1000 * 60 * 60 * 24);\r\n};\r\n\r\n// Changed from 'const analyzePlantHealth =' to 'export const analyzePlantHealth ='\r\nexport const analyzePlantHealth = (plant, weatherData, gardenItem = null) => {\r\n  const alerts = [];\r\n  const status = { health: \"OPTIMAL\", alerts: [], next_actions: {} };\r\n\r\n  // SAFETY CHECK: If weather or plant data is missing, return a loading state\r\n  if (!weatherData || !plant || !plant.ecological_descriptors) {\r\n    return { health: \"ANALYZING...\", alerts: [], next_actions: {} };\r\n  }\r\n\r\n  // 1. Check Temperature\r\n  const currentTemp = weatherData.main.temp;\r\n  const tempRange = parseRange(plant.ecological_descriptors.temperature_range);\r\n\r\n  if (tempRange) {\r\n    if (currentTemp < tempRange.min) {\r\n      alerts.push(`TOO COLD! CURR: ${Math.round(currentTemp)}Â°C (NEEDS ${tempRange.min}Â°C)`);\r\n    } else if (currentTemp > tempRange.max) {\r\n      alerts.push(`TOO HOT! CURR: ${Math.round(currentTemp)}Â°C (MAX ${tempRange.max}Â°C)`);\r\n    }\r\n  }\r\n\r\n  // 2. Humidity Check\r\n  const currentHumidity = weatherData.main.humidity;\r\n  const humidityReq = plant.ecological_descriptors.humidity_level || \"\";\r\n  if (humidityReq.toLowerCase().includes(\"high\") && currentHumidity < 40) {\r\n    alerts.push(`DRY AIR (${currentHumidity}%). MIST NEEDED.`);\r\n  }\r\n\r\n  // 3. Smart Watering Schedule\r\n  if (gardenItem && gardenItem.last_watered) {\r\n    const daysSinceWatering = differenceInDays(\r\n      new Date(),\r\n      new Date(gardenItem.last_watered)\r\n    );\r\n\r\n    let requiredDays = 7;\r\n    const freq = plant.ecological_descriptors.water_frequency.toLowerCase();\r\n\r\n    if (freq.includes(\"daily\")) requiredDays = 1;\r\n    else if (freq.includes(\"bi-weekly\") || freq.includes(\"2 weeks\")) requiredDays = 14;\r\n    else if (freq.includes(\"weekly\")) requiredDays = 7;\r\n\r\n    const isRaining = weatherData.weather[0].main.toLowerCase().includes(\"rain\");\r\n    if (isRaining) {\r\n      requiredDays += 2;\r\n      alerts.push(\"ðŸŒ§ï¸ RAIN DETECTED: WATERING DELAYED 2 DAYS.\");\r\n    }\r\n\r\n    const dueInDays = requiredDays - daysSinceWatering;\r\n\r\n    if (dueInDays <= 0) {\r\n      status.health = \"THIRSTY\";\r\n      status.next_actions.water_in = \"NOW\";\r\n      alerts.push(`ðŸ’§ TIME TO WATER!`);\r\n    } else {\r\n      status.next_actions.water_in = `${Math.round(dueInDays)} DAYS`;\r\n    }\r\n  }\r\n\r\n  if (alerts.length > 0 && status.health === \"OPTIMAL\") {\r\n    status.health = \"NEEDS ATTENTION\";\r\n  }\r\n  status.alerts = alerts;\r\n\r\n  return status;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}